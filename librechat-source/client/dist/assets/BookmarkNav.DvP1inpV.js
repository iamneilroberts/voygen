import{r as e,j as s,cN as a}from"./vendor.QZPQzs41.js";import{x as t,e as r,$ as o,u as i,a as n,s as l,r as c,c as m,B as d}from"./index.UXHUINA1.js";import{af as u,ag as j,aj as p}from"./radix-ui.DIuKTTg8.js";import"./utilities.TtBcTuYn.js";import{d as x}from"./tanstack-vendor.BbSalNlj.js";import{E as g,l as h,y as f,P as b}from"./headlessui.egow6G5u.js";import"./react-interactions.Cds8bkli.js";import"./markdown_highlight.YFvJ8PVJ.js";import"./validation.CeCA-dRw.js";import"./math-katex.steiuUVT.js";import"./locales.C-8hb_Wy.js";import"./i18n.TuT91fVs.js";import"./routing.CZ6KW51v.js";import"./avatars.h8saQOOS.js";import"./advanced-inputs.CN2NHLBj.js";import"./animations.Cx0QIz5u.js";import"./virtualization.6Ae2FQ1H.js";import"./framer-motion.BmOjVs-Z.js";import"./http-client.B90rh5_2.js";import"./date-utils.j-oxXFG2.js";import"./forms.zrou0Dk0.js";import"./security-ui.BYob0MN8.js";import"./heic-converter.Cz_Prg7D.js";import"./markdown-processing.YKncLuzT.js";import"./sandpack.DwlIa5L8.js";import"./codemirror-core.B2vmsuiN.js";import"./codemirror-state.Pf71Wo5N.js";import"./codemirror-view.Cxs3wxnG.js";import"./codemirror-language.DIsqm2pZ.js";const v=({tag:a,selected:t,handleSubmit:r,icon:i,...n})=>{const[l,c]=e.useState(!1);return s.jsx(g,{"aria-label":a,className:"group flex w-full gap-2 rounded-lg p-2.5 text-sm text-text-primary transition-colors duration-200 focus:outline-none data-[focus]:bg-surface-hover data-[focus-visible]:ring-2 data-[focus-visible]:ring-primary",...n,as:"button",onClick:async()=>{"New Bookmark"!==a?(c(!0),r(a),c(!1)):r()},children:s.jsx("div",{className:"flex grow items-center justify-between gap-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[null!=i?i:l?s.jsx(o,{className:"size-4"}):t?s.jsx(u,{className:"size-4"}):s.jsx(j,{className:"size-4"}),s.jsx("div",{style:{wordBreak:"break-word",overflowWrap:"anywhere"},children:a})]})})})},k=({tags:e,handleSubmit:a,header:t})=>{const{bookmarks:r}=i();return s.jsxs(s.Fragment,{children:[t,r.length>0&&s.jsx("div",{className:"my-1.5 h-px",role:"none"}),r.map(((t,r)=>s.jsx(v,{tag:t.tag,selected:e.includes(t.tag),handleSubmit:a},`${t._id??t.tag}-${r}`)))]})},N=({conversation:a,tags:t=[],setTags:r})=>{const[o,l]=e.useState(),{bookmarks:c}=i(),m=n();e.useEffect((()=>{o||l(a)}),[a,o]);const d=()=>{r([])};return 0===c.length?s.jsxs("div",{className:"flex flex-col",children:[s.jsx(v,{tag:m("com_ui_clear_all"),"data-testid":"bookmark-item-clear",handleSubmit:d,selected:!1,icon:s.jsx(p,{className:"size-4"})}),s.jsx(v,{tag:m("com_ui_no_bookmarks"),"data-testid":"bookmark-item-no-bookmarks",handleSubmit:()=>Promise.resolve(),selected:!1,icon:"ðŸ¤”"})]}):s.jsx("div",{className:"flex flex-col",children:s.jsx(k,{tags:t,handleSubmit:e=>{if(void 0===e)return;const s=(e=>t.some((s=>s===e))?t.filter((s=>s!==e)):[...t,e])(e);r(s)},header:s.jsx(v,{tag:m("com_ui_clear_all"),"data-testid":"bookmark-item-clear",handleSubmit:d,selected:!1,icon:s.jsx(p,{className:"size-4"})})})})},y=({tags:o,setTags:i,isSmallScreen:p})=>{const g=n(),{data:v}=x([r.conversationTags],(()=>t.getConversationTags()),{refetchOnWindowFocus:!1,refetchOnReconnect:!1,refetchOnMount:!1,...k});var k;const y=a(l.conversationByIndex(0)),w=e.useMemo((()=>o.length>0?o.join(", "):g("com_ui_bookmarks")),[o,g]);return s.jsx(h,{as:"div",className:"group relative",children:({open:e})=>s.jsxs(s.Fragment,{children:[s.jsx(c,{description:w,render:s.jsx(f,{id:"bookmark-menu-button","aria-label":g("com_ui_bookmarks"),className:m("flex items-center justify-center","size-10 border-none text-text-primary hover:bg-accent hover:text-accent-foreground","rounded-full border-none p-2 hover:bg-surface-hover md:rounded-xl",e?"bg-surface-hover":""),"data-testid":"bookmark-menu",children:o.length>0?s.jsx(u,{className:"icon-lg text-text-primary","aria-hidden":"true"}):s.jsx(j,{className:"icon-lg text-text-primary","aria-hidden":"true"})})}),s.jsx(b,{anchor:"bottom",className:"absolute left-0 top-full z-[100] mt-1 w-60 translate-y-0 overflow-hidden rounded-lg bg-surface-secondary p-1.5 shadow-lg outline-none",children:v&&y&&s.jsx(d.Provider,{value:{bookmarks:v.filter((e=>e.count>0))},children:s.jsx(N,{conversation:y,tags:o,setTags:i})})})]})})};export{y as default};
